<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Title</title>
    <script src="js/jquery-3.1.1.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <style>
        .caret{
            margin-top: 0px;
            width: 0;
            height: 0;
            border-top: 10px solid #000;
            border-right: 5px solid transparent;
            border-left: 5px solid transparent;
            border-bottom: 0px solid transparent;
        }

        .ppp{
            width: 100px;
            height: 100px;
            border: 1px solid;
            border-color: darkgray;
            text-align: center;
            float: left;

        }
        .ppy{
            width: 40px;
            height: 40px;
            border-radius: 50% ;
            background-color: black;
            text-align: center;
            margin:0 auto;

            margin-top: -10px;
        }

        .tb1 th,td{
            border-right: 1px solid;border-right-color:darkgray;
            text-align: center;
            height: 35px;

        }
        .pagestyle{
            display: inline-block;
            padding: 0;
            margin: 0;
        }
        .pagestyle li{
            display: inline;
        }

        .pagestyle li a{
            color: black;
            float: left;
            padding: 8px 16px;
            text-decoration: none;
        }
        .xx1{
            border-top: solid 3px rgb(223, 226, 231);
            margin-left: -2px;
            margin-right: -2px;
            margin-top: -2px;
            z-index: 30;
            box-shadow: none;
            border: none;
        }


        .my-btn button{


            margin-top: 20px;
            margin-left: 200px;






        }

        .moda-div{

            position: fixed;
            width: 40%;
            height: 30%;
            background-color: yellow;
            z-index:100;
        }


    </style>

</head>

<body style="background-color: rgb(223, 226, 231)">





<div class="moda-div" id="moda" hidden></div>
<div class="container" style="margin-top: 50px;">
    <div class="row">
        <div class="col-lg-10 col-lg-offset-1" style="border-bottom: 1px solid;padding: 0%">

            <!--<div class="col-lg-2">-->
            <label style="width: 200px;color: darkgray;"><a href="#" style="color: darkgray;">个人待办事项管理系统</a>
            </label><br>
            <!--</div>-->
            <label style="border-bottom: 2px solid;margin-bottom: 0px;margin-top: 30px;">待办事项</label>
        </div>

    </div>

</div>



<div class="container">

    <div class="row">
        <div class="col-lg-10 col-lg-offset-1 " style="padding-right: 0%;padding-left: 0%">
            <div class="col-lg-3" style="height: 400px;border-bottom: 3px solid;border-top: 3px solid;margin-top: 1px;margin-bottom: 5px;">
                <nav class="navbar" role="navigation" style="margin-top: 40px;">

                    <div class="container-fluid" style="padding: 0%;margin: 0%;">
                        <ul style="list-style-type: none;padding: 0%;margin: 0%;text-align: center">
                            <li style="border-bottom: 1px dotted;width: 100%;height: 30px;"><a href="#.html" style="color: black;font-size: medium">待办事项列表</a></li>
                            <li style="border-bottom: 1px dotted;width: 100%;height: 30px;"><a href="My2.html" style="color: black;font-size: medium">个人信息维护</a></li>
                        </ul>
                    </div>


                </nav>
            </div>

            <div class="col-lg-9" style="height: 600px;padding-right: 0%;">
                <div  style="height: 400px;margin-left:10px;margin-right:0;margin-top: 1px;border-bottom: 3px solid;border-top: 3px solid;">

                    <nav class="navbar" role="navigation" style="margin-top: 0px;padding: 0;">
                        <div style="padding: 0%;margin: 0%;">

                            <ul class="nav navbar-nav my-btn" >
                                <li style="margin-left: 0%;padding-left: 0%;">
                                    <button type="button" class="btn "  data-toggle="modal" data-target="#myModal2" style="margin-left: 20px;">新增</button> </li>


                                <li style="margin-left: 0%;padding-left: 0%;">
                                    <button type="button" class="btn " id="btn-click2" style="display: none">更新</button> </li>

                                <li style="margin-left: 0%;padding-left: 0%;">
                                    <button type="button" class="btn " style="display: none">删除</button> </li>

                                <li >
                        &nbsp; &nbsp; &nbsp; <span style="line-height:70px;">点击列表查看详情/更新/删除</span>
                                </li>





                            </ul>





                        </div>
                    </nav>
                    <div style="width: 100%;height: 500px;" >
                        <table class="table tb1" id="itemstable">



                        </table>
                        <div style="width: 100%;height: 50px;text-align: right">
                            <ul class="pagestyle" >
                                <li><a href="#" >&laquo;</a></li>
                                <li><a href="#"> &lt;</a></li>
                                <li><a href="#">1</a></li>
                                <li><a href="#" class="active">2</a></li>

                                <li><a href="#">3</a></li>
                                <li><a href="#">4</a></li>
                                <li><a href="#">5</a></li>
                                <li><a href="#">7</a></li>
                                <li><a href="#">8</a></li>
                                <li><a href="#">&gt;</a></li>
                                <li><a href="#">&raquo;</a></li>
                            </ul>
                        </div>

                    </div>


                </div>
            </div>




        </div>

    </div>


</div>
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" >
    <div class="modal-dialog" style="margin-top: 300px;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                    &times;
                </button>
                <label>标题</label>
                <h4 class="modal-title" id="myModalLabel">
                    模态框（Modal）标题
                </h4>
                <input type="text" hidden id="gtitle">

            </div>
            <div class="modal-body" >
                <label>内容</label>  <label id="itemcontent">标题</label><textarea  hidden id="gcontemt"></textarea>
            </div>
            <div class="modal-body">
                <label>优先级</label>  <label id="itempriority">标题</label>

                <select hidden id="gpriority">
                    <option value ="HIGH">HIGH</option>
                    <option value ="MEDIUM">MEDIUM</option>
                    <option value="LOW">LOW</option>

                </select>
            </div>
            <p id="item_id" hidden></p>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal" id="btnstop">关闭
                </button>
                <button type="button" class="btn btn-default" data-dismiss="modal" id="btndelete">删除
                </button>
                <button type="button" class="btn btn-primary" id="btnxiugai">
                    更新
                </button>
                <button type="button" class="btn btn-primary" style="display:none;" id="btntijiao">
                    提交
                </button>
            </div>
        </div><!-- /.modal-content -->
    </div>
</div>





<div class="modal fade" id="myModal2" tabindex="-1" role="dialog" aria-labelledby="myModalLabel2" aria-hidden="true" >
    <div class="modal-dialog" style="margin-top: 300px;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                    &times;
                </button>
                <label>标题</label>

                <input type="text"  id="gtitle2">

            </div>
            <div class="modal-body" >
                <label>内容</label> <textarea  id="gcontemt2"></textarea>
            </div>
            <div class="modal-body">
                <label>优先级</label>

                <select  id="gpriority2">
                    <option value ="HIGH">HIGH</option>
                    <option value ="MEDIUM">MEDIUM</option>
                    <option value="LOW">LOW</option>

                </select>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal" id="btnstop2">关闭
                </button>
                <button type="button" class="btn btn-primary" id="btnxiugai2">
                    提交
                </button>
            </div>
        </div><!-- /.modal-content -->
    </div>
</div>

<script >
    $(document).ready(function(){

           loaditem();
        $('#btnxiugai').click(function(){
            var a= $('#myModalLabel').html();
            $('#gtitle').val(a);
            $('#myModalLabel').hide();
            $('#gtitle').show();

            a= $('#itemcontent').html();
            $('#gcontemt').val(a);
            $('#itemcontent').hide();
            $('#gcontemt').show();

            $('#itempriority').hide();
            $('#gpriority').show();


            $('#btnxiugai').hide();
            $('#btntijiao').show();
            

        });







        $('#btndelete').click(function(){

            $('#btnxiugai').show();
            aaa();

        });
        $('#btnstop').click(function(){

            $('#btnxiugai').show();
            $('#btntijiao').hide();
            aaa();

        });


        $('#btnstop2').click(function(){
            $('#gtitle2').val("");

            $('#gcontemt2').val("");






        });

        $('#btndelete').click(function(){



            var item_id=$('#item_id').text();


            $.post("deleteItem.do",
                    {

                        todo_item_id:item_id
                    },
                    function(data,status){
                        var json=$.parseJSON(data);
                        if(json.deleteItem=="success"){
                            alert("删除成功");
                            loaditem();
                        }
                        else{
                            alert("删除失败");

                        }
                    });



        });


        $('#btntijiao').click(function(){

                    var todo_item_title=$('#gtitle').val();
                    var todo_item_content=$('#gcontemt').val();
                    var priority=$('#gpriority').val();
                    var todo_item_id=$('#item_id').text();



                    $.post("updateItem.do",
                            {

                                todo_item_title:todo_item_title,
                                todo_item_content:todo_item_content,
                                priority:priority,
                                todo_item_id:todo_item_id

                            },
                            function(data,status){
                                var json=$.parseJSON(data);
                                if(json.updateItem=="success"){
                                    alert("更新成功");
                                    aaa();
                                    loaditem();
                                    $('#btnxiugai').show();
                                    $('#btntijiao').hide();
                                    $('#myModal').modal("hide");
                                }
                                else{
                                    alert("更新失败");

                                }
                            });




                }
        );



        $('#btnxiugai2').click(function(){

                    var todo_item_title=$('#gtitle2').val();
                    var todo_item_content=$('#gcontemt2').val();
                    var priority=$('#gpriority2').val();
                     


                    $.post("addItem.do",
                            {

                                todo_item_title:todo_item_title,
                                todo_item_content:todo_item_content,
                                priority:priority


                            },
                            function(data,status){
                                var json=$.parseJSON(data);
                                if(json.addItem=="success"){
                                    alert("增加成功");

                                    loaditem();


                                    $('#myModal2').modal("hide");
                                }
                                else{
                                    alert("增加失败");

                                }
                            });




                }
        );




    });



    function tableclick(){


        $('#itemstable tr').click(function(){

            var a=$(this).find("td").eq(1).html()
            $('#myModalLabel').html(a);
            a=$(this).find("td").eq(2).html()
            $('#itemcontent').html(a);

            a=$(this).find("td").eq(3).html()
            $('#itempriority').html(a);

            a=$(this).find("td").eq(5).html()

            $('#item_id').html(a);

            $('#myModal').modal({backdrop: 'static', keyboard: false});

        });
    }
    function aaa(){
        $('#myModalLabel').show();
        $('#gtitle').hide();



        $('#itemcontent').show();
        $('#gcontemt').hide();




        $('#itempriority').show();
        $('#gpriority').hide();
    }









    $("#btn-click2").click( loaditem());


    function loaditem(){
        $.getJSON("myItems.do",function(result){
            var a=" <tr> <th > 序号</th><th >标题 </th><th >内容</th>  <th >优先级 </th><th >创建时间 </th><th > 更新时间 </th></tr>";
            $('#itemstable').html(a);

            $.each(result.items, function(i, item){


                $('#itemstable').append("<tr> <td>"+i+"</td>"+"<td>"+ item.title+"</td>"+"<td>"+item.content+"</td>"+"<td>"+item.priority+"</td>"+"<td>"+item.creation_date+"</td>"+"<td hidden>"+item.item_id+"</td>"+"<td>"+item.last_update_date+"</td></tr>");

            });
            tableclick();
        });


    }


</script>



</body>
</html>
